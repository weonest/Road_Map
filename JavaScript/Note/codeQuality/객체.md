# 객체

[자료형](https://ko.javascript.info/types) 챕터에서 배웠듯이 자바스크립트엔 여덟 가지 자료형이 있다. 이 중 일곱 개는 오직 하나의 데이터(문자열, 숫자 등)만 담을 수 있어 '원시형(primitive type)'이라 부른다.

그런데 객체형은 원시형과 달리 다양한 데이터를 담을 수 있다. 키로 구분된 데이터 집합이나 복잡한 개체(entity)를 저장할 수 있다.

객체는 중괄호 `{...}` 를 이용해 만들 수 있다. 중괄호 안에는 ‘키(key) : 값 (value)’ 쌍으로 구성된 프로퍼티(property) 를 여러 개 넣을 수 있는데, `키` 엔 문자형, `값` 엔 모든 자료형이 허용된다. 프로퍼티 키는 ‘프로퍼티 이름’ 이라고 부른다.

- 빈 객체를 만드는 방법은 두 가지가 있다.

```jsx
let user = new Object(); // '객체 생성자' 문법
let user = {};  // '객체 리터럴' 문법
```

중괄호 `{...}`를 이용해 객체를 선언하는 것을 객체 리터럴(obejct literal)이라고 부른다.

## 리터럴과 프로퍼티

중괄호 `{...}` 안에는 ‘키: 값’ 쌍으로 구성된 프로퍼티가 들어간다.

```jsx
let user = {     // 객체
  name: "John",  // 키: "name",  값: "John"
  age: 30**,**        // 키: "age", 값: 30
};
```

`'콜론(:)'` 을 기준으로 왼쪽엔 키가, 오른쪽엔 값이 위치한다. 프로퍼티 키는 프로퍼티 ‘이름’ 혹은 ‘식별자’라고도 부른다.

서랍장에 파일을 추가하고 뺄 수 있듯이 개발자는 프로퍼티를 추가, 삭제할 수 있다.

점 표기법(dot notation)을 이용하면 프로퍼티 값을 읽는 것도 가능하다.

```jsx
// 프로퍼티 값 얻기
alert( user.name ); // John
alert( user.age ); // 30

// 프로퍼티 값 삭제
delete user.age;
```

- 프로퍼티 값엔 **모든 자료형이** 올 수 있다.

> **상수 객체는 수정될 수 있다.**
>
> ```jsx
> **const user = { // const로 선언된 객체는 수정될 수 있다.**
>   name: "John"
> };
> 
> user.name = "Pete"; // (*)
> 
> alert(user.name); // Pete
> ```
>
> `const`는 한 번이라도 값을 할당한 변수가 변경되는 걸 막습니다.
>
> 변수 `user`는 객체 참조 값을 저장하고 있는데, `const`는 이 값이 변경되는걸 막는 것이지, 객체의 내용(프로퍼티)을 변경하는 건 막지 않습니다.

## 대괄호 표기법

키가 유효한 변수 식별자가 아닌 경우엔 점 표기법 대신에 ‘대괄호 표기법(square bracket notation)’이라 불리는 방법을 사용할 수 있다. 대괄호 표기법은 키에 어떤 문자열이 있던지 상관없이 동작한다.

```jsx
let user = {};

// set
user["likes birds"] = true;

// get
alert(user["likes birds"]); // true

// delete
delete user["likes birds"];
```

대괄호 표기법을 사용하면 아래 예시에서 변수를 키로 사용한 것과 같이 문자열뿐만 아니라 모든 표현식의 평가 결과를 프로퍼티 키로 사용할 수 있다.

```jsx
let key = "likes birds";

// user["likes birds"] = true; 와 같습니다.
user[key] = true;
```

- 변수 `key` 는 런타임에 평가되기 때문에 사용자 입력값 변경 등에 따라 값이 변경될 수 있다. 어떤 경우든, 평가가 끝난 이후의 결과가 프로퍼티 키로 사용된다.

예시

```jsx
let user = {
  name: "John",
  age: 30
};

let key = prompt("사용자의 어떤 정보를 얻고 싶으신가요?", "name");

// 변수로 접근
alert( user[key] ); // John (프롬프트 창에 "name"을 입력한 경우)
```

- 그런데 점 표기법은 이런 방식이 불가능하다.

```jsx
let user = {
  name: "John",
  age: 30
};

let key = "name";
alert( user.key ) // undefined
```

## 계산된 프로퍼티

객체를 만들 때 객체 리터럴 안의 프로퍼티 키가 대괄호로 둘러싸여 있는 경우, 이를 계산된 프로퍼티(computed property)라고 부른다.

```jsx
let fruit = prompt("어떤 과일을 구매하시겠습니까?", "apple");

let bag = {
  [fruit]: 5, // 변수 fruit에서 프로퍼티 이름을 동적으로 받아 옵니다.
};

alert( bag.apple ); // fruit에 "apple"이 할당되었다면, 5가 출력됩니다.
```

위 예시에서 `[fruit]` 는 프로퍼티 이름을 변수 `fruit` 에서 가져오겠다는 것.

사용자가 프롬프트 대화상자에 `apple` 을 입력했다면 `bag` 엔 `{apple: 5}` 가 할당. 아래 예시는 위 예시와 동일하게 작동

```jsx
let fruit = prompt("어떤 과일을 구매하시겠습니까?", "apple");
let bag = {};

// 변수 fruit을 사용해 프로퍼티 이름을 만들었습니다.
bag[fruit] = 5;
```

한편, 다음 예시처럼 대괄호 안에는 복잡한 표현식이 올 수도 있다.

```jsx
let fruit = 'apple';
let bag = {
  [fruit + 'Computers']: 5 // bag.appleComputers = 5
};
```

대괄호 표기법은 프로퍼티 이름과 값의 제약을 없애주기 때문에 점 표기법보다 훨씬 강력하다.

프로퍼티 이름이 확정된 상황이고, 단순한 이름이라면 점 표기법을 사용하다가 뭔가 복잡한 상황이 발생했을 때 대괄호 표기법으로 바꾸는 경우가 많다.

## 단축 프로퍼티

```jsx
function makeUser(name, age) {
  return {
    name: name,
    age: age,
    // ...등등
  };
}

let user = makeUser("John", 30);
alert(user.name); // John
```

이렇게 변수를 사용해 프로퍼티를 만드는 경우는 아주 흔한데, 프로퍼티 값 단축 구문(property value shorthand)을 사용하면 코드를 짧게 줄일 수 있다.

`name:name` 대신 `name`만 적어줘도 프로퍼티를 설정할 수 있다.

```jsx
function makeUser(name, age) {
  return {
    **name, // name: name 과 같음
    age,  // age: age 와 같음**
    // ...
  };
}
```

## 프로퍼티 이름의 제약사항

아시다시피 변수 이름(키)엔 ‘for’, ‘let’, ‘return’ 같은 예약어를 사용하면 안된다.

그런데 객체 프로퍼티엔 이런 제약이 없다.

```jsx
// 예약어를 키로 사용해도 괜찮습니다.
let obj = {
  for: 1,
  let: 2,
  return: 3
};

alert( obj.for + obj.let + obj.return );  // 6
```

**문자형이나 심볼형에 속하지 않는 값은 문자열로 자동 형 변환된다.**

```jsx
let obj = {
  0: "test" // "0": "test"와 동일합니다.
};

// 숫자 0은 문자열 "0"으로 변환되기 때문에 두 얼럿 창은 같은 프로퍼티에 접근합니다,
alert( obj["0"] ); // test
alert( obj[0] ); // test (동일한 프로퍼티)
```

## ‘in’ 연산자로 프로퍼티 존재 여부 확인하기

객체의 중요한 특징 중 하나는 다른 언어와는 달리, 존재하지 않는 프로퍼티에 접근하려 해도 에러가 발생하지 않고 `undefined` 를 반환한다는 것이다.

이런 특징을 응용하면 프로퍼티 존재 여부를 쉽게 확인할 수 있다.

```jsx
let user = {};

alert( user.noSuchProperty === undefined ); // true는 '프로퍼티가 존재하지 않음'을 의미합니다.
```

이렇게 `undefined` 와 비교하는 것 이외에도 연사자 `in` 을 사용하면 프로퍼티 존재 여부를 확인할 수 있다.

```jsx
let user = { age: 30 };

let key = "age";
alert( key in user ); // true, 변수 key에 저장된 값("age")을 사용해 프로퍼티 존재 여부를 확인합니다.
let user = { name: "John", age: 30 };

alert( "age" in user ); // user.age가 존재하므로 true가 출력됩니다.
alert( "blabla" in user ); // user.blabla는 존재하지 않기 때문에 false가 출력됩니다.
```

- `in` 왼쪽엔 반드시 프로퍼티 이름이 와야 한다. **프로퍼티 이름은 보통 따옴표로 감싼 문자열이다.** 따옴표를 생략하면 엉뚱한 변수가 조사 대상이 된다.

그런데 `undefined` 가 있음에도 `in` 연산자가 왜 필요할까?

대부분의 경우, 일치 연산자를 사용해서 프로퍼티 존재 여부를 알아내는 방법은 꽤 잘 동작한다. 하지만, 가끔 이 방법이 실패할 때도 있다.

프로퍼티는 존재하는데, 값에 `undefined` 를 할당한 예시가 그러하다.

## ‘for…in’ 반복문

`for..in` 반복문을 사용하면 객체의 모든 키를 순회할 수 있다. `for..in`은 앞서 학습했던 반복문과는 완전히 다른 문법이다.

```jsx
for (key in object) {
  // 각 프로퍼티 키(key)를 이용하여 본문(body)을 실행합니다.
}
```

아래 예시를 실행하면 객체 `user` 의 모든 프로퍼티가 출력된다.

```jsx
let user = {
  name: "John",
  age: 30,
  isAdmin: true
};

for (let key in user) {
  // 키
  alert( key );  // name, age, isAdmin
  // 키에 해당하는 값
  alert( user[key] ); // John, 30, true
}
```

`let key` 부분에서, 반복 변수명은 자유롭게 정할 수 있다. `for (let babo in obj)` 와 같이 말이다.

## 객체 정렬 방식

객체는 ‘특별한 방식으로 정렬’된다. **정수 프로퍼티**는 자동으로 정렬되고, 그 외의 프로퍼티는 객체에 추가한 순서 그대로 정렬된다.

> **정수 프로퍼티? 그게 뭔가요?**
>
> ‘정수 프로퍼티’라는 용어는 변형 없이 정수에서 왔다 갔다 할 수 있는 문자열.
>
> 문자열”49”는 정수로 변환하거나 변환한 정수를 다시 문자열로 바꿔도 변형이 없기 때문에 정수 프로퍼티이다. 하지만 “+49”와 “1.2”는 정수 프로퍼티가 아니다.
>
> ```jsx
> // 함수 Math.trunc는 소수점 아래를 버리고 숫자의 정수부만 반환합니다.
> alert( String(Math.trunc(Number("49"))) ); // '49'가 출력됩니다. 기존에 입력한 값과 같으므로 정수 프로퍼티입니다.
> alert( String(Math.trunc(Number("+49"))) ); // '49'가 출력됩니다. 기존에 입력한 값(+49)과 다르므로 정수 프로퍼티가 아닙니다.
> alert( String(Math.trunc(Number("1.2"))) ); // '1'이 출력됩니다. 기존에 입력한 값(1.2)과 다르므로 정수 프로퍼티가 아닙니다.
> ```

```jsx
let codes = {
  "49": "독일",
  "41": "스위스",
  "44": "영국",
  // ..,
  "1": "미국"
};

for (let code in codes) {
  alert(code); // 1, 41, 44, 49
}
```

위 예시에서 독일을 가장 위에 출력하도록 하려면 나라 번호가 정수로 취급되지 않도록 속임수를 쓰면 된다. 각 나로 번호 앞에 `"+"` 를 붙여서 말이다.

```jsx
let codes = {
  "+49": "독일",
  "+41": "스위스",
  "+44": "영국",
  // ..,
  "+1": "미국"
};

for (let code in codes) {
  alert( +code ); // 49, 41, 44, 1
}
```

# [요약](https://ko.javascript.info/object#ref-2585)

객체는 몇 가지 특수한 기능을 가진 연관 배열(associative array)입니다.

객체는 프로퍼티(키-값 쌍)를 저장합니다.

- 프로퍼티 키는 문자열이나 심볼이어야 합니다. 보통은 문자열입니다.
- 값은 어떤 자료형도 가능합니다.

아래와 같은 방법을 사용하면 프로퍼티에 접근할 수 있습니다.

- 점 표기법: `obj.property`
- 대괄호 표기법 `obj["property"]`. 대괄호 표기법을 사용하면 `obj[varWithKey]`같이 변수에서 키를 가져올 수 있습니다.

객체엔 다음과 같은 추가 연산자를 사용할 수 있습니다.

- 프로퍼티를 삭제하고 싶을 때: `delete obj.prop`
- 해당 key를 가진 프로퍼티가 객체 내에 있는지 확인하고자 할 때: `"key" in obj`
- 프로퍼티를 나열할 때: `for (let key in obj)`

지금까진 '순수 객체(plain object)'라 불리는 일반 `객체`에 대해 학습했습니다.

자바스크립트에는 일반 객체 이외에도 다양한 종류의 객체가 있습니다.

- `Array` – 정렬된 데이터 컬렉션을 저장할 때 쓰임
- `Date` – 날짜와 시간 정보를 저장할 때 쓰임
- `Error` – 에러 정보를 저장할 때 쓰임
- 기타 등등