# Token

------

## Token 이란?

클라이언트에서 인증 정보를 보관하는 방법이다.

세션 기반 인증은 클라이언트에서 유저 정보를 요청 할 때마다 해당 정보를 줘도 되는지에 대해 세션 값 일치여부를 확인했었다. 매 요청마다 DB를 살펴보는 것이 불편하고, 부담이 되었기 때문에 토큰 기반 인증 개념이 생겨났다.

비록 클라이언트에 저장해서 보안에 취약할 수 있다고 생각이 들지만, 토큰은 유저 정보를 암호화 한 상태로 담을 수 있고, 암호화했기 때문에 클라이언트에 담을 수 있다.

토큰에는 여러 종류가 있는데, 그 중에서 개방형이고 웹에서 널리 쓰이는 JWT에 대해 알아보자

### JWT란?

Json Web Token의 약자로 웹에서 쓰이는 json 토큰이다

종류는 access token, refresh token 두 가지이다

### Access Token & Refresh Token

access token은 보호된 정보들에 접근할 수 있는 권한부여에 사용된다.

즉, 클라이언트가 처음 인증을 받게 될 때 (로그인) access token, refresh token 둘 다 받게 되지만, 실제로 권한을 얻는데 사용하는 토큰은 access token 이다

권한을 부여받는 데엔 access token 만 있으면 된다. 하지만 해커에 의해 토큰이 탈취된다면, 로그인을 해서 여러 나쁜 행위들을 할 수 있다.

그래서 access token의 만료기간을 짧게 주고 오랫동안 사용할 수 없도록 한다.

access token 이 만료될 때마다 refresh token을 통해 새로운 access token을 refresh 한다.

> access token은 로그인 정보에 접근할 수 있는 카드키
>
> refresh token은 카드키 재발급이라고 생각하자

유저의 편의보다 정보를 지키는 것이 더 중요한 웹사이트들은 refresh token을 사용하지 않는 곳도 있다. 그러면 유저는 일정주기 마다 새로 로그인을 해야 할 것이다. 로그인 제한시간을 두는 예와 비슷하다

## 토큰 기반 인증의 장점

### 비상태성 & 확장성

- 서버는 클라이언트에 대한 정보를 저장할 필요가 없다
- 클라이언트는 새로운 요청을 보낼 때마다 토큰을 헤더에 포함시키면 된다
- signature을 받은 토큰을 사용하고, 암호화 키를 노출할 필요가 없기 때문에 안전하다
- 어디서나 생성 가능하다
- 권한 부여에 용이하다